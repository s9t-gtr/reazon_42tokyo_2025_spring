# ボタンAPIドキュメント

## 概要

このAPIは、ボタンの状態（ON/OFF）を切り替える機能を提供します。ボタンIDを指定することで、そのボタンの状態をトグル（ONからOFFまたはその逆）できます。また、ボタン1が初めて押された場合、その押下時刻を記録し、再度ボタン1が押されると、その経過時間を計算してセッションに保存します。

## エンドポイント

### 1. ボタンの状態の更新

#### `PUT /api/button/:id`

**説明**  
指定したボタンの状態（`status`）をトグルします。ボタン1が押されると、経過時間を計算し、セッションに保存します。ボタン1が初めて押された場合、セッションが作成され、そのIDがレスポンスとして返されます。再度ボタン1が押された場合、経過時間が更新されます。

**パスパラメータ**

- `id` (整数): 更新するボタンのID

**リクエストボディ**

リクエストボディは必要ありません。このエンドポイントはボタンのIDを指定して、そのボタンの状態をトグルするのみです。

**レスポンス（成功時）**

- **ボタン1が初めて押された場合**

```json
{
  "status": "OK",
  "session_id": 123
}
```

- **ボタン1が再度押された場合**

```json
{
  "status": "OK",
  "session_id": 123,
  "elapsed_time": 150
}
```

- **その他のボタンが押された場合**

```json
{
  "id": 2,
  "name": "Button2",
  "status": false
}
```

**レスポンス（エラー時）**

- **404 Not Found**: 指定されたボタンIDが存在しない場合

```json
{
  "error": "Button not found"
}
```

- **404 Not Found**: セッションが見つからない場合（ボタン1が再度押された際）

```json
{
  "error": "Session not found"
}
```

## データ処理の流れ

1. リクエストで指定されたボタンIDを取得します。
2. メモリ内の擬似データ（`BUTTONS`）を検索し、該当するボタンが存在するかを確認します。
3. 存在する場合、そのボタンの`status`をトグルします（`true`から`false`またはその逆に切り替え）。
4. ボタンIDが1の場合、初回押下時はセッションが作成され、そのIDがレスポンスとして返されます。再度ボタン1が押されると、経過時間が計算され、その値とともにセッションが更新されます。
5. 更新後のボタン情報をJSON形式で返します。
6. ボタンIDが見つからない場合、エラーメッセージとともに404エラーを返します。

## 注意事項

- このAPIはデータベースを使用せず、メモリ内の擬似データを使用しています。サーバーが再起動されると、データは失われます。
- ボタンIDは現在は1から3の間であると仮定されています。それ以外のIDを指定するとエラーになります。
- ボタン1が初めて押された際には新しいセッションが作成され、`session_id`が返されます。再度ボタン1が押されると、その経過時間（秒）が`elapsed_time`として返され、セッションが更新されます。

## 例: `curl` コマンドによるリクエスト

- ボタンID 1の状態をトグルし、初回押下時にセッションIDを取得するリクエスト:

```sh
curl -X PUT http://localhost:3001/api/button/1 \
  -H "Content-Type: application/json"
```

- ボタンID 1の状態を再度トグルし、経過時間を確認するリクエスト:

```sh
curl -X PUT http://localhost:3001/api/button/1 \
  -H "Content-Type: application/json"
```

- 他のボタンの状態をトグルするリクエスト（例: ボタン2の状態）:

```sh
curl -X PUT http://localhost:3001/api/button/2 \
  -H "Content-Type: application/json"
```
